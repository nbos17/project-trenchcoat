<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Test</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" integrity="sha384-Zug+QiDoJOrZ5t4lssLdxGhVrurbmBWopoEl+M6BdEfwnCJZtKxi1KgxUyJq13dy" crossorigin="anonymous">
  <style>
  	#modal {
  		background-color: red;
  		border-width: 2px;
  		border-style: solid;
  		border-color: black;
  		position: relative;
  		display: none;
  		z-index: 1;
  		padding: 30px;
  		left: 50%;
  		top: 50%;
  		float: left;
  		transform: translate(-50%, -50%);


  	}
  	#modalHeader {
  		margin-bottom: 25px;
  	}
  	#Proceed {
  		margin-right: 20px;
  	}
</style>
</head>

<body>
	<div class='container'>
	<h1 style=' margin-bottom: 30px'>Face Recognition API</h1>
	<div class='row'>
		<form id="form" style=" margin-right: 10px">
			Input link here:
			<input type='text' id="link" placeholder = "Enter jpg or png">
		</form>
		<button id='Submit'>Submit</button>
	</div>

	<div class = 'row' id=response></div>
	<div class = 'row' id='image' style='margin-top: 30px'>Image Submitted: </div>
	<div class = 'row' id='modal'>
		<div class = 'col-md-12' id= 'modalContent'>
			<h1 id='modalHeader'>Are You Sure You Want To Creep?</h1>
			<button id='Proceed'>Confirm Creep</button>
			<button id='goBack'>NO, Go Back</button>
		</div>
	</div>
 </div>



<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript">



$('#Submit').on('click', function(event) {

	$('#modal').css('display', 'block');
	$('body').css('background-color', 'grey');

	$('#goBack').on('click', function(event){
		event.preventDefault(); 
		$('#modal').css('display', 'none');
		$('body').css('background-color', 'white');

	});

	$('#Proceed').on('click', function(event) {

		event.preventDefault(); 
		$('#modal').css('display', 'none');
		$('body').css('background-color', 'white');

	var cors_api_host = 'cors-anywhere.herokuapp.com';
	

	// Gather link to image
	var source = $('#link').val();
	console.log(source);

	//show image on html
	var newImage = $('<img>');
	newImage.attr('src', source);
	$('#image').append(newImage);

	//header keys
	var headers = {
		"app_id"          : "59fe3f8b",
		"app_key"         : "472b1119c610482500bfb00b6e897a1c"
	};
	
	//emotion api call
	var url = "http://" + cors_api_host + '/https://api.kairos.com/v2/media?source=' + source ;
	$.ajax(url, {
		headers  : headers,
	    type: "POST",
	    dataType: "JSON"
	}).done(function(response){
		
		console.log(response);
		$('#response').text(JSON.stringify(response));
		
	});

	//face recognition api call
	var urlFace = "http://" + cors_api_host +  "/http://api.kairos.com/detect";
	var payload  = { "image" : source };
	$.ajax(urlFace, {
		headers  : headers,
	    type: "POST",
	    data: JSON.stringify(payload),
	    dataType: "JSON"
	}).done(function(response){
		
		console.log(response);
		//$('#response').text(JSON.stringify(response));
	}); 

});



	


});

</script>
</body>
